import{r as p,j as n}from"./react-0fb5d424.js";import{l as y}from"./lodash-a5a67b6f.js";import{c as X,u as Y}from"./@wangeditor-f081fcca.js";import{s as j,k as z}from"./index-a637b915.js";import"./dayjs-e40d92c3.js";import"./@babel-25fffde3.js";import"./react-dom-0d6193a3.js";import"./scheduler-765c72db.js";import"./react-router-dom-8732fd06.js";import"./react-router-3e4edb2d.js";import"./@remix-run-7c45f29c.js";import"./react-redux-54c164ec.js";import"./use-sync-external-store-29364900.js";import"./mock-95d2a412.js";import"./mockjs-9c967a30.js";import"./antd-d4271c6f.js";import"./rc-util-48ba7f71.js";import"./react-is-e8e5dbb3.js";import"./classnames-fe2c27d8.js";import"./rc-resize-observer-745b2131.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./rc-motion-eb90ae56.js";import"./@ant-design-60842819.js";import"./@emotion-c0b5c018.js";import"./stylis-c78c9806.js";import"./@ctrl-fb5a5473.js";import"./rc-picker-6e445fc6.js";import"./@rc-component-ed6c637d.js";import"./rc-tabs-3b6d1d00.js";import"./rc-dropdown-3ade4447.js";import"./rc-menu-83466686.js";import"./rc-overflow-114563da.js";import"./rc-trigger-8e81b561.js";import"./rc-align-3928b621.js";import"./dom-align-ecb06dd6.js";import"./rc-cascader-5bc29b89.js";import"./rc-select-3f77be03.js";import"./rc-virtual-list-27fe0724.js";import"./rc-tree-586f51e7.js";import"./rc-input-number-83428087.js";import"./rc-collapse-62224ade.js";import"./rc-drawer-f0808ac3.js";import"./rc-field-form-10847344.js";import"./async-validator-dee29e8b.js";import"./scroll-into-view-if-needed-640b7801.js";import"./compute-scroll-into-view-50f8bc03.js";import"./rc-image-1fde4eb3.js";import"./rc-dialog-fa40b945.js";import"./rc-notification-3e0c56c9.js";import"./rc-tooltip-f3685bbd.js";import"./rc-rate-49702ee4.js";import"./rc-slider-a4dd6cf2.js";import"./rc-steps-fcee3d43.js";import"./rc-switch-9e1e6b4a.js";import"./rc-table-dcede9bc.js";import"./rc-pagination-88d89b42.js";import"./throttle-debounce-87e7e444.js";import"./rc-checkbox-d7b3fa29.js";import"./rc-input-3e170e62.js";import"./rc-textarea-3d294471.js";import"./rc-upload-215eca2a.js";import"./rc-progress-48fe049f.js";import"./@reduxjs-c09949f6.js";import"./redux-ea15d17b.js";import"./reselect-8f3bbdd7.js";import"./redux-thunk-f771c803.js";import"./axios-4a70c6fc.js";import"./qs-0173dd19.js";import"./side-channel-5b5a05bd.js";import"./get-intrinsic-45907aec.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-f7d0b240.js";import"./function-bind-61637ca6.js";import"./has-57b382c3.js";import"./call-bind-c38f6426.js";import"./object-inspect-42714f7a.js";import"./vite-plugin-mock-d7a8ead1.js";import"./path-to-regexp-31db6522.js";function D(e){return e=Number(e)/1024,e>=1024?e=(e/1024).toFixed(2)+"MB":e=e.toFixed(2)+"kb",e}function v(e){return e.isEmpty()||e.getText()===""}function L(e=5*1024*1024){return{fieldName:"file",allowedFileTypes:["image/*"],maxFileSize:e,meta:{path:"/ums-admin/editor-image"},withCredentials:!0,customInsert(t,o){if(!t){j("系统异常","error");return}const{data:r,code:s,msg:m="上传失败"}=t;if(s!==200){j(m,"error");return}o(r==null?void 0:r.url,"","")},onError(t){const{size:o}=t;o>e&&j(`图片大小不能超过${D(e)}`,"warning")}}}function tt(e="",t=[],o=[],r="color: red;",s="color: darkorange;"){const m=new RegExp(`(${t.join("|")})|(${o.join("|")})`,"gi");return e?e.replace(m,(a,c,g)=>`<span style="${t.includes(a)?r:s}">${a}</span>`):""}function et(e=""){const t=document.createElement("div");return t.innerHTML=e,t.innerText}function k(e={}){let t="";return t=Object.entries(e).map(([r,s],m)=>(r=r.replace(/([A-Z])/g,"-$1").toLowerCase(),`${r}:${s};`)).join(""),t}const rt="_tips_mzo10_16",A={"base-editor":"_base-editor_mzo10_11",tips:rt};let V="",T=!1;const w="",ot={wrong:{color:"red"},sens:{color:"darkorange"}},st=["header1","bold","indent","delIndent","justifyLeft","justifyRight","justifyCenter","justifyJustify","bulletedList","numberedList","uploadImage","redo","undo","fullScreen"],it={},nt={placeholder:"请输入内容",autoFocus:!1,MENU_CONF:{uploadImage:{}},customPaste(e,t){const{clipboardData:o}=t||{},r=(o==null?void 0:o.getData("text/plain"))||"";try{const s=e.getFragment();if(Array.isArray(s)&&s.some(c=>c.type==="table"))return e.insertText(r),t.preventDefault(),!1;const a=r.split("\r").map(c=>`<div>${(c||"").replace(/([]|\r|\n)/g,"")}</div>`).join("");e.dangerouslyInsertHtml(a)}catch{e.insertText(r.replace(/([]|\r)/g,""))}return t.preventDefault(),!1}},mt=({className:e="",value:t="",onCreated:o,onChange:r,onBlur:s,onFocus:m,editorStyle:a={height:"300px"},toolbarKeys:c=st,maxLength:g,toolbarConfig:E={},editorConfig:O={},toolbarProps:R={},editorProps:U={},showImgTips:Z=!1,wordsList:l,wordsStyle:B,insertMenu:h})=>{var _,C,H,I;const[M,b]=p.useState(""),S=p.useRef(!1),[x,N]=p.useState(null),{wrong:W,sens:$}=y.merge({},ot,B),u=L(),F=u==null?void 0:u.allowedFileTypes.map(i=>i.split("/")[1]).join("、"),J=D(u==null?void 0:u.maxFileSize),d=y.merge({},it,E,{toolbarKeys:c}),P=y.merge({},nt,{onBlur(){T=!1,s==null||s()},onFocus(){T=!0,m==null||m()},MENU_CONF:{uploadImage:u}},O,{maxLength:g});p.useEffect(()=>{h==null||h()},[]),p.useEffect(()=>()=>{x&&(x.destroy(),N(null))},[x]),p.useEffect(()=>{if(!t)b(w);else{if(l&&!T){const{wrong:i,sens:f}=l;t=et(t),t=tt(t,i,f,k(W),k($))}t.startsWith("<p>")||(t="<p>"+t),t.endsWith("</p>")||(t+="</p>"),b(t)}},[t,l]);function q(i){N(i),o==null||o(i)}const G=y.debounce(i=>{const f=v(i)?w:i.getHtml();if(V!==f){const K=i.getText();V=f,S.current?setTimeout(()=>{console.log("onChange--------------------Z"),r==null||r(f,K,i)},50):(console.log("onChange--------------------"),r==null||r(f,K,i))}},500),Q=p.useCallback(i=>{S.current=(i.ctrlKey||i.metaKey)&&i.key==="z"},[]);return z("keydown",Q),n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:`${e} ${A["base-editor"]}`,children:[!!((_=d.toolbarKeys)!=null&&_.length)&&n.jsx(X,{mode:"default",style:{borderBottom:"1px solid #ccc"},editor:x,defaultConfig:d,...R}),n.jsx(Y,{mode:"simple",style:a,value:M,onCreated:q,onChange:G,defaultConfig:P,...U})]}),Z&&((C=d==null?void 0:d.toolbarKeys)==null?void 0:C.includes("uploadImage"))&&n.jsxs("div",{className:A.tips,children:["注：",F==="*"?"":`图片只能上传${F}格式，`,"每张图片大小不能超过",J,"。"]}),!!l&&n.jsxs("div",{className:"f-sb-c mt-8",children:[n.jsxs("div",{className:"f-1",children:[n.jsx("span",{children:"疑似敏感词："}),n.jsx("span",{style:$,children:(H=l==null?void 0:l.sens)==null?void 0:H.join("、")})]}),n.jsxs("div",{className:"f-1",children:[n.jsx("span",{children:"疑似错别字："}),n.jsx("span",{style:W,children:(I=l==null?void 0:l.wrong)==null?void 0:I.join("、")})]})]})]})},ke=({className:e=""})=>{const[t,o]=p.useState([]),[r,s]=p.useState([]),[m,a]=p.useState("");p.useEffect(()=>{c()},[]);function c(){setTimeout(()=>{o(["祖国","田野"]),s(["假象","上"]),a("我们的假象，在希望的田野上，热爱我们的祖国！")},500)}function g(){setTimeout(()=>{o(["祖"]),s(["假"])},500)}return n.jsx(n.Fragment,{children:n.jsx(mt,{value:m,onBlur:g,onChange:a,wordsList:{wrong:r,sens:t}})})};export{ke as default};
